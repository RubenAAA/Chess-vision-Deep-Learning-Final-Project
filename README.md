# ğŸ Chess Vision AI ğŸ

This project detects, recognizes, and evaluates chess positions from images using **YOLO-based board and piece detection**, **Stockfish engine analysis**, and **python-chess visualization**.

## ğŸš€ Features

- **Chessboard Detection (YOLOv8)**
  - Identifies board intersections and structures the grid.
  - Extends an infinite grid to ensure robustness.

- **Piece Recognition (YOLOv8)**
  - Detects and assigns chess pieces to board squares.

- **Position Reconstruction**
  - Converts detected pieces into **Forsyth-Edwards Notation (FEN)**.
  - Ensures correct board orientation (White at the bottom).

- **Stockfish Evaluation**
  - Finds the **best move** for White or Black.
  - Provides **positional evaluation metrics** (material, mobility, king safety, etc.).
  - Displays an interactive chessboard with recommended moves.

## ğŸ“¦ Installation

### **1ï¸âƒ£ Install Dependencies**
Install the required packages:

```bash
pip install -r requirements.txt
```

### **2ï¸âƒ£ Install Stockfish (Required for Move Evaluation)**
Download and extract **Stockfish 15+**:
- **Windows**: [Download](https://stockfishchess.org/download/) â†’ Add `stockfish.exe` to PATH.
- **Linux**: Install via package manager:

## ğŸ›  Usage

### **Run the Chess Vision Pipeline**
To detect the board and evaluate the position, run:

```bash
python chess_vision.py
```

### **Train Custom YOLO Models (Optional)**
To retrain the board and piece detection models:

```python
# Uncomment in chess_vision.py
train_board_detection()
train_piece_detection()
```

### **Interactive Analysis in Jupyter Notebook**
To analyze images interactively:

```python
from chess_utils import display_eval, get_best_move

best_move_white = get_best_move(full_fen_w)
print("Best move for white:", best_move_white)
display_eval(full_fen_w, best_move_white)
```

## ğŸ“Š Chess Evaluation Metrics

| **Metric**       | **Description** |
|------------------|------------------------------------------------|
| **Material**     | Overall material balance (e.g., pawn=1, queen=9). |
| **Imbalance**    | Positional differences beyond raw material count. |
| **Pawns**        | Pawn structure analysis (passed, isolated, doubled). |
| **Knights**      | Activity of knights (outposts, mobility). |
| **Bishops**      | Bishop activity, control over long diagonals. |
| **Rooks**        | Rook activity (open files, 7th rank control). |
| **Queens**       | Queen's mobility and placement effectiveness. |
| **Mobility**     | Legal move count, indicating piece activity. |
| **King Safety**  | King protection (pawn cover, exposure). |
| **Threats**      | Tactical threats present in the position. |
| **Passed Pawns** | Presence and strength of passed pawns. |
| **Space**        | Board control and territory. |
| **Winnability**  | Heuristic measure of winning chances. |
| **Total**        | Aggregate evaluation (in centipawns). |

## ğŸ— Project Structure

```text
final_project/
â”œâ”€â”€ __pycache__/
â”‚   â””â”€â”€ ... (compiled Python files)
â”œâ”€â”€ datasets/
â”‚   â””â”€â”€ ... (dataset files used for training/detection)
â”œâ”€â”€ cornerx_detection/
â”‚   â””â”€â”€ ... (corner detection logic or scripts)
â”œâ”€â”€ pieces_detection/
â”‚   â””â”€â”€ ... (chess piece detection logic or scripts)
â”œâ”€â”€ results/
â”‚   â””â”€â”€ ... (output results or logs)
â”œâ”€â”€ runs/
â”‚   â”œâ”€â”€ detect/
â”‚   â”œâ”€â”€ detect_board/
â”‚   â””â”€â”€ detect_pieces/
â”‚       â””â”€â”€ ... (folders automatically generated by detection runs)
â”œâ”€â”€ stockfish_15_linux/
â”‚   â””â”€â”€ ... (Stockfish engine for Linux)
â”œâ”€â”€ stockfish_15_windows/
â”‚   â””â”€â”€ ... (Stockfish engine for Windows)
â”œâ”€â”€ chessboard.jpg
â”œâ”€â”€ chess_vision.ipynb
â”œâ”€â”€ yolo11n.pt
â”œâ”€â”€ board_config.yml
â”œâ”€â”€ pieces_config.yml
â”œâ”€â”€ models.py
â”œâ”€â”€ chess_utils.py
â”œâ”€â”€ stockfish_utils.py
â”œâ”€â”€ README.md
â””â”€â”€ requirements.txt

```

## ğŸ”— Resources
- [Stockfish's website](https://stockfishchess.org/)
- [Stockfish 15 Chess Engine download link](https://drive.google.com/drive/folders/1ASj7nGkFlZB-RLZxcmYa47sq4moN4aAb)
- [Ultralytics YOLOv8](https://github.com/ultralytics/ultralytics)
- [python-chess](https://python-chess.readthedocs.io/en/latest/)

## ğŸ“œ License
This project is **MIT Licensed** â€“ feel free to use, modify, and distribute.

---

ğŸ”¥ **Contributors Welcome!** Submit pull requests or issues to improve the pipeline. ğŸš€â™Ÿï¸
